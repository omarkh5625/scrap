# ุญู ุงููุดููุฉ: ูุตู ุงููุงุฌูุฉ (UI) ุนู ุงููุธุงู ุงูุฎููู (Backend) ูุชุญุณูู ุฃุฏุงุก ุงูุนูุงู

## ๐ฏ ูุธุฑุฉ ุนุงูุฉ ุนูู ุงูุญู

ุชู ุชุทููุฑ ุญู ุดุงูู ููุตู ุชูุงููุง ุจูู ูุงุฌูุฉ ุงููุณุชุฎุฏู ูุงููุธุงู ุงูุฎูููุ ูุน ุชุญุณููุงุช ูุฏุนู ุชุดุบูู 300 ุนุงูู (Worker) ุจููุงุกุฉ ุนุงููุฉ.

## ๐ ูููู ุงููููุงุช ุงูุฌุฏูุฏ

```
โโโ app.php                    # ุงูุชุทุจูู ุงูุฃุตูู (ูุง ุฒุงู ูุนูู)
โโโ api.php                    # ุฌุฏูุฏ: ูุงุฌูุฉ API ูููุธุงู ุงูุฎููู (ูููุตูุฉ ุชูุงูุงู)
โโโ worker.php                 # ุฌุฏูุฏ: ุณูุฑุจุช ุนุงูู ูุณุชูู
โโโ dashboard.html             # ุฌุฏูุฏ: ูุงุฌูุฉ ูุณุชุฎุฏู ูููุฉ (ุชุณุชููู API)
โโโ README_ARCHITECTURE.md     # ุชูุซูู ุจุงููุบุฉ ุงูุฅูุฌููุฒูุฉ
โโโ README_ARABIC.md           # ูุฐุง ุงูููู
```

## โ ูุง ุชู ุฅูุฌุงุฒู

### 1. ูุตู ุงููุงุฌูุฉ ุนู ุงููุธุงู ุงูุฎููู

#### ุงููุงุฌูุฉ (UI) - `dashboard.html`
- โ ูุงุฌูุฉ ูุณุชุฎุฏู HTML/CSS/JavaScript ุฎุงูุตุฉ
- โ ูุง ุชูุฌุฏ ุฃู ุชุจุนูุงุช PHP
- โ ุชุชุตู ุจุงููุธุงู ุงูุฎููู ุนุจุฑ API ููุท
- โ ูููู ุงุณุชุถุงูุชูุง ุจุดูู ูููุตู ุฃู ุนูู CDN
- โ ุชุญุฏูุซุงุช ููุฑูุฉ ูู 5 ุซูุงูู
- โ ุชุตููู ูุชุฌุงูุจ ูุนูู ุนูู ุงูุฌูุงู

#### ุงููุธุงู ุงูุฎููู (Backend) - `api.php`
- โ ูุงุฌูุฉ RESTful API ูุงููุฉ
- โ ูููุตูุฉ ุชูุงูุงู ุนู ุงููุงุฌูุฉ
- โ ูููู ุงุณุชุฎุฏุงููุง ูู ุฃู ุชุทุจูู ุฎุงุฑุฌู
- โ ุฏุนู CORS ูููุตูู ูู ุฃู ูุตุฏุฑ
- โ ุชูุณูู JSON ููุฑุฏูุฏ

### 2. ูุธุงู ุงูุนูุงู ุงููุญุณูู

#### ุงูุนุงูู ุงููุณุชูู - `worker.php`
- โ ุณูุฑุจุช CLI ูุนูู ุจุดูู ูุณุชูู
- โ ูุนุงูุฌุฉ ูุชูุงุฒูุฉ ุญููููุฉ
- โ ุฐุงูุฑุฉ ูุญุณููุฉ (256MB ููู ุนุงูู)
- โ ูุนุงูุฌุฉ ุฃุฎุทุงุก ุชููุงุฆูุฉ
- โ ูุฑุงูุจุฉ ูุจุถ ุงูููุจ (Heartbeat)
- โ ุชุณุฌูู ุฃุฎุทุงุก ุชูุตููู

### 3. ุชุญุณููุงุช ุงูุฃุฏุงุก ูู 300 ุนุงูู

#### ุฃ. ุฅุฏุงุฑุฉ ูุงุนุฏุฉ ุงูุจูุงูุงุช
- ุชุฌููุน ุงูุงุชุตุงูุงุช (Connection Pooling)
- ุนูููุงุช ุฅุฏุฎุงู ุฌูุงุนูุฉ (Bulk Insert)
- ููุฑุณุฉ ูุญุณููุฉ ููุฌุฏุงูู
- ูุนุงููุงุช ุขููุฉ ูููุฑุงุกุฉ/ุงููุชุงุจุฉ

#### ุจ. ูุธุงู ูุงุฆูุฉ ุงูุงูุชุธุงุฑ
- ุชูุฒูุน ุงูููุงู ุนูู ุงูุนูุงู
- ูุนุงูุฌุฉ ูุชูุงุฒูุฉ ุจุฏูู ุชุถุงุฑุจ
- ุชุชุจุน ุชูุฏู ุชููุงุฆู
- ุฅุนุงุฏุฉ ูุญุงููุฉ ุนูุฏ ุงููุดู

#### ุฌ. ุฅุฏุงุฑุฉ ุงูุฐุงูุฑุฉ
- ุญุฏ ุฐุงูุฑุฉ ุฃูู ููุนูุงู (256MB)
- ุฐุงูุฑุฉ ุชุฎุฒูู ูุคูุช BloomFilter (10K ุนูุตุฑ)
- ุนูููุงุช ุฌูุงุนูุฉ ูุชูููู ุงุณุชุฎุฏุงู ุงูุฐุงูุฑุฉ

#### ุฏ. ุทูุจุงุช HTTP ุงููุชูุงุฒูุฉ
- ุงุณุชุฎุฏุงู curl_multi
- ุญุชู 100 ุงุชุตุงู ูุชุฒุงูู ููู ุนุงูู
- ุฅุนุงุฏุฉ ุงุณุชุฎุฏุงู ุงูุงุชุตุงูุงุช (Keep-Alive)
- ุฏุนู HTTP/2

## ๐ ููููุฉ ุงูุงุณุชุฎุฏุงู

### ุงูุทุฑููุฉ 1: ุงุณุชุฎุฏุงู ุงููุงุฌูุฉ ุงูุฌุฏูุฏุฉ

1. **ุงูุชุญ ููุญุฉ ุงูุชุญูู:**
   ```
   ุงูุชุญ dashboard.html ูู ุงููุชุตูุญ
   ```

2. **ุฃูุดุฆ ูููุฉ ุฌุฏูุฏุฉ:**
   - ุงููุฃ ุงููููุฐุฌ ุจุงูุจูุงูุงุช ุงููุทููุจุฉ
   - ุงุฎุชุฑ ุนุฏุฏ ุงูุนูุงู (ุชููุงุฆู ุฃู ูุฏูู ุญุชู 300)
   - ุงุถุบุท "๐ Start Extraction"
   - ุณูุชู ุชุดุบูู ุงูุนูุงู ุชููุงุฆูุงู

### ุงูุทุฑููุฉ 2: ุงุณุชุฎุฏุงู API ูุจุงุดุฑุฉ

```bash
# ุฅูุดุงุก ูููุฉ
curl -X POST "api.php?action=create_job" \
  -H "Content-Type: application/json" \
  -d '{
    "query": "real estate agents california",
    "api_key": "YOUR_API_KEY",
    "max_results": 1000,
    "worker_count": 50
  }'

# ุชุดุบูู ุงูุนูุงู
curl -X POST "api.php?action=spawn_workers" \
  -d '{"worker_count":50}'

# ุงูุชุญูู ูู ุงูุญุงูุฉ
curl "api.php?action=get_system_status"
```

### ุงูุทุฑููุฉ 3: ุชุดุบูู ุนูุงู ูุฏููุงู

```bash
# ุชุดุบูู ุนุงูู ูุงุญุฏ
php worker.php worker_1

# ุชุดุบูู 50 ุนุงูู ูู ุงูุฎูููุฉ
for i in {1..50}; do
  php worker.php "worker_$i" &
done

# ุชุดุบูู 300 ุนุงูู (ุงูุญุฏ ุงูุฃูุตู)
for i in {1..300}; do
  php worker.php "worker_$i" &
done
```

## ๐ ููุงุท API ุงููุชุงุญุฉ

### ุฅุฏุงุฑุฉ ุงูููุงู
- `?action=create_job` - ุฅูุดุงุก ูููุฉ ุฌุฏูุฏุฉ
- `?action=get_jobs` - ุงูุญุตูู ุนูู ุฌููุน ุงูููุงู
- `?action=get_job&job_id=X` - ุชูุงุตูู ูููุฉ ูุญุฏุฏุฉ
- `?action=get_job_results&job_id=X` - ูุชุงุฆุฌ ุงููููุฉ

### ุฅุฏุงุฑุฉ ุงูุนูุงู
- `?action=get_workers` - ุงูุญุตูู ุนูู ุฌููุน ุงูุนูุงู
- `?action=get_worker_stats` - ุฅุญุตุงุฆูุงุช ุงูุนูุงู
- `?action=spawn_workers` - ุชุดุบูู ุนูุงู ุฌุฏุฏ

### ุงููุฑุงูุจุฉ
- `?action=get_queue_stats` - ุฅุญุตุงุฆูุงุช ูุงุฆูุฉ ุงูุงูุชุธุงุฑ
- `?action=get_errors` - ุณุฌู ุงูุฃุฎุทุงุก
- `?action=resolve_error` - ุญู ุฎุทุฃ
- `?action=get_system_status` - ุญุงูุฉ ุงููุธุงู ุงูุนุงูุฉ
- `?action=health` - ูุญุต ุตุญุฉ ุงููุธุงู

## ๐ช ููุงููุณ ุงูุฃุฏุงุก

### ุนุงูู ูุงุญุฏ
- ~100 ุจุฑูุฏ ุฅููุชุฑููู/ุฏูููุฉ
- ~3-5 ุซูุงูู ููู ุตูุญุฉ ูุชุงุฆุฌ
- ุงุณุชุฎุฏุงู ุงูุฐุงูุฑุฉ: 50-100MB

### 50 ุนุงูู (ููุตู ุจู)
- ~5,000 ุจุฑูุฏ ุฅููุชุฑููู/ุฏูููุฉ
- 100,000 ุจุฑูุฏ ูู ~20 ุฏูููุฉ
- ุฅุฌูุงูู ุงูุฐุงูุฑุฉ: 3-5GB

### 300 ุนุงูู (ุงูุญุฏ ุงูุฃูุตู)
- ~30,000 ุจุฑูุฏ ุฅููุชุฑููู/ุฏูููุฉ
- 100,000 ุจุฑูุฏ ูู ~3-4 ุฏูุงุฆู
- ุฅุฌูุงูู ุงูุฐุงูุฑุฉ: 15-20GB
- **ููุงุญุธุฉ:** ูุชุทูุจ ุฎุงุฏู ูุฎุตุต ุจููุงุฑุฏ ูุงููุฉ

## ๐ง ูุชุทูุจุงุช ุงููุธุงู

### ูู 50 ุนุงูู (ููุตู ุจู):
- 4-8 GB RAM
- 2-4 ุฃูููุฉ CPU
- ูุงุนุฏุฉ ุจูุงูุงุช MySQL
- PHP 8.0+

### ูู 300 ุนุงูู (ุงูุญุฏ ุงูุฃูุตู):
- 16+ GB RAM
- 8+ ุฃูููุฉ CPU
- ุชุฎุฒูู SSD ููุงุนุฏุฉ ุงูุจูุงูุงุช
- ุงุชุตุงู ุดุจูุฉ ุฌูุฌุงุจุช
- ุฎุงุฏู ูุฎุตุต

## ๐ฏ ุงููุฒุงูุง ุงูุฑุฆูุณูุฉ

| ุงูููุฒุฉ | ุงููุฏูู (Monolithic) | ุงูุฌุฏูุฏ (Separated) |
|---------|---------------------|---------------------|
| **ุงูุฑุจุท ุจูู UI/Backend** | ูุฑุชุจุท ุจุดูู ูุซูู | ูููุตู ุชูุงูุงู โ |
| **ุงููุตูู ุนุจุฑ API** | โ ุบูุฑ ูุชููุฑ | โ ูุชููุฑ |
| **ูุงุจููุฉ ุงูุชูุณุน** | ูุญุฏูุฏุฉ | ุญุชู 300 ุนุงูู โ |
| **ุฏุนู ุงูุฌูุงู** | โ ูุง | โ ูุนู |
| **ุงูุชูุงูู ุงูุฎุงุฑุฌู** | โ ุตุนุจ | โ ุณูู (API) |
| **ุชูุฒูุน ุงูุญูู** | โ ูุง | โ ูููู |
| **ุงูุตูุงูุฉ** | ุตุนุจุฉ | ุณููุฉ โ |

## ๐ ุงููุฑุงูุจุฉ ูุงูุชุดุฎูุต

### ูุญุต ุตุญุฉ API
```bash
curl "api.php?action=health"
```

### ุนุฑุถ ุณุฌูุงุช ุงูุนูุงู
```bash
tail -f php_errors.log
```

### ูุฑุงูุจุฉ ุงูุนูุงู ุงููุดุทุฉ
```bash
curl "api.php?action=get_workers" | json_pp
```

### ุงูุชุญูู ูู ุญุงูุฉ ูุงุฆูุฉ ุงูุงูุชุธุงุฑ
```bash
curl "api.php?action=get_queue_stats" | json_pp
```

## ๐ก๏ธ ุงูุฃูุงู

### ููุงุณุชุฎุฏุงู ูู ุงูุฅูุชุงุฌ:

1. **ุฅุถุงูุฉ ูุตุงุฏูุฉ API:**
   ```php
   $apiKey = $_SERVER['HTTP_X_API_KEY'] ?? '';
   if ($apiKey !== 'your-secret-key') {
       apiError('Unauthorized', 401);
   }
   ```

2. **ุชูููุฏ CORS:**
   ```php
   header('Access-Control-Allow-Origin: https://yourdomain.com');
   ```

3. **ุชุญุฏูุฏ ูุนุฏู ุงูุทูุจุงุช:**
   - ููุน ุงูุงุณุชุฎุฏุงู ุงูููุฑุท
   - ุญูุงูุฉ ูู ุงููุฌูุงุช

## ๐ ุฃูุถู ุงูููุงุฑุณุงุช

### ูุชุดุบูู 300 ุนุงูู ุจูุฌุงุญ:

1. **ุชุญุณูู ูุงุนุฏุฉ ุงูุจูุงูุงุช:**
   ```sql
   CREATE INDEX idx_job_queue_status ON job_queue(status);
   CREATE INDEX idx_workers_status ON workers(status);
   OPTIMIZE TABLE job_queue;
   OPTIMIZE TABLE workers;
   ```

2. **ุฅุนุฏุงุฏุงุช ุงููุธุงู:**
   ```bash
   ulimit -n 65536  # ุฒูุงุฏุฉ ุญุฏ ุงููููุงุช ุงูููุชูุญุฉ
   ulimit -u 4096   # ุฒูุงุฏุฉ ุญุฏ ุงูุนูููุงุช
   ```

3. **ุฅุนุฏุงุฏุงุช PHP:**
   ```ini
   max_execution_time = 300
   memory_limit = 512M
   ```

## โ๏ธ ููุงุญุธุงุช ูููุฉ

1. **ุงูุชุทุจูู ุงูุฃุตูู (`app.php`) ูุง ุฒุงู ูุนูู:**
   - ูู ูุชู ูุณุฑ ุฃู ูุธููุฉ ููุฌูุฏุฉ
   - ูููู ุงูุงุณุชูุฑุงุฑ ูู ุงุณุชุฎุฏุงูู
   - ุงูุงูุชูุงู ุงูุชุฏุฑูุฌู ูููู

2. **ุงููุฌุฑุฉ ุงูุชุฏุฑูุฌูุฉ:**
   - ุงุจุฏุฃ ุจุงุณุชุฎุฏุงู API ููุนูููุงุช ุงูุจุฑูุฌูุฉ
   - ุงูุชูู ุฅูู dashboard.html ูููุงุฌูุฉ
   - ุงุญุชูุธ ุจู app.php ูุฎุทุฉ ุงุญุชูุงุทูุฉ

3. **ุงูุฃุฏุงุก ุงูุฃูุซู:**
   - 50 ุนุงูู ูุซุงูู ููุนุธู ุงูุงุณุชุฎุฏุงูุงุช
   - 300 ุนุงูู ูุชุทูุจ ููุงุฑุฏ ุฎุงุฏู ูุจูุฑุฉ
   - ุงุจุฏุฃ ุตุบูุฑุงู ููู ุจุงูุชูุณุน ุชุฏุฑูุฌูุงู

## ๐ ุงููุชูุฌุฉ ุงูููุงุฆูุฉ

โ **ูุตู ุชุงู ุจูู ุงููุงุฌูุฉ ูุงููุธุงู ุงูุฎููู**
โ **ูุธุงู ูุณุชูุฑ ูุงุฏุฑ ุนูู ุชุดุบูู 300 ุนุงูู**
โ **ูุงุฌูุฉ API ูุงููุฉ ููุชูุงูู ุงูุฎุงุฑุฌู**
โ **ุฃุฏุงุก ูุญุณูู ููุงุจููุฉ ุชูุณุน ุนุงููุฉ**
โ **ูุฑุงูุจุฉ ูุชุณุฌูู ุฃุฎุทุงุก ุดุงููุฉ**
โ **ุชูุซูู ูุงูู ุจุงููุบุชูู ุงูุนุฑุจูุฉ ูุงูุฅูุฌููุฒูุฉ**

## ๐ ุงูุฏุนู

ููุฃุณุฆูุฉ ุฃู ุงููุดุงูู:
1. ุชุญูู ูู `php_errors.log` ููุฃุฎุทุงุก ุงูุชูุตูููุฉ
2. ุงุณุชุฎุฏู ููุทุฉ ูุญุต ุงูุตุญุฉ: `api.php?action=health`
3. ุฑุงูุจ ุญุงูุฉ ุงูุนูุงู: `api.php?action=get_workers`

---

**ุชู ุงูุชุทููุฑ ุจุญุจ โค๏ธ ูุฃุฌู ุงูุฃุฏุงุก ููุงุจููุฉ ุงูุชูุณุน**
